# 링크 계층
## 링크 계층의 역할
- 물리적으로 인접한 노드들 사이에서 데이터그램을 전달 
### 노드
- 호스트
- 라우터
### 엣지
- 링크
  - 유선 링크
  - 무선 링크
  - 통신망 (LANs)
### Layer-2 패킷
- 데이터 단위
- Later-2 패킷 = 프레임 (frame)
- 상위계층의 데이터그램을 캡슐화함

<br>

## 링크 계층은 어디에 구현?
### 전송, 네트워크 계층은 어디에 구현?
- OS 내부에 구현
### 링크, 물리 계층은 어디에 구현?
- 어댑터or 칩 형태로 구현
- ex) 이더넷 카드, 무선 랜카드
- 어댑터는 호스트의 시스템 버스에 연결 (예 : PCI슬롯)

<br>

---

<br>

### 링크의 두 가지 타입
- point to point : 1:1로 직접연결
- broadcaset (shared wire or medium) : 공유된 채널에 여러 장치가 연결 (multiple access link)
 
<br>

# Multiple Access Link
### MAC
- Medium Access Control
- 공유된 매체에 접근할 때 충동하지 않게 컨트롤
- WIFI LTE 이더넷 등

<br>

## MAC 프로콜 분류
- 크게 3가지로 분류된다.
### 1. 채널 분할 (Channel Partition)
- TDMA : 시간을 분할
- FDMA : 주파수 대역을 분할
- 단점 : 빈 슬롯은 자원을 낭비한 것. 
### 2. 랜덤 엑세스 (Random Access)
- CSMA : 전송 전에 채널의 상황을 듣는다.
  - idle일 때 frame을 전송, busy일 땐 연기
- CSMA collision
  - 전파지연으로 서로의 신호를 못받아서, 동시에 전송해버림 (충돌)
  - 재전송 해야되서 사실상 자원을 낭비한 것
- CSMA CD (Collision Detection)
  - 충돌을 감지하면 멈춘다.
  - 이진 (지수) 백오프 한다.  
### 3. 교대로 사용하기 (Taking Turns)
- 마스터가 전송할 노드 정해주는 방법
- 토큰을 가진 노드가 전송하는 방법
- 단점 : 토큰을 잃거나, 마스터가 고장나면 전부 망함. (하나에 의존하는 취약점)
### 어떤게 좋을까?
- 노드가 많을 때 : Channel Partition
- 노드 수가 중간정도 일 때 : Taking Turns 
- 노드가 적을 때 : Random Access

---

# LAN
- Local Area Network
- shared medium도 LAN임
## 이더넷
- 지배적인 유선 LAN 기술
- 물리적 토폴로지
  - 버스 토폴로지 : 옛날 방식, 충돌 발생
  - 스타 토롤로지 : 현재 대부분이 사용, 스위치 사용, 충돌x
- CSMA/CD 알고리즘 사용
  - (P) 충돌 시간 감지 문제
    - CSMA/CD 프로토콜은 ark를 사용하지 않는다.
    - CSMA/CD 프로토콜은 데이터를 보내면서, 다른 데이터가 들어오면 충돌로 판단한다
    - 실제로는 충돌이 발생했는데, 전송이 완료된 뒤에 데이터가 들어오면 충돌로 판단하지 않는 문제가 있다.
  - (S) Minimum frame size
    - 데이터를 좀 더 길게 보냈으면 충돌을 탐지했을 것이다
    - 그래서 최소한 64바이트 이상으로 프레임을 보내기로 약속
## 스타 토폴로지
- 스위치를 사용한다
### 스위치 
- 노드가 아니다. 네트워크 계층에선 없는것 취급, next hop에 스위치는 포함x
- 충돌이 안생겨서 **동시 전송 가능**
- **self-learning**을 통해, 스위치 포워딩 테이블을 만들고, 패킷을 보내야 할 곳에 보냄
- 포워딩 테이블에 아직 적히지 않은곳은 **플러딩**을 통해 알아냄
  - 라우터 포워딩 테이블 : 링크 스테이트, 거리벡터 알고리즘
  - 스위치 포워딩 테이블 : self-learning
- 노드가 많아지면, 스위치끼리 연결해서 계층화시킴
